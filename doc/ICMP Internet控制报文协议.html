<p>ICMP<span style="font-family: 宋体;">端口不可达验证。</span></p>
<p>1<span style="font-family: 宋体;">、</span>准备</p>
<p>window<span style="font-family: 宋体;">上下载</span><span style="font-family: Times New Roman;">tftp32</span><span style="font-family: 宋体;">软件，并设置好服务器</span><span style="font-family: Times New Roman;">IP</span><span style="font-family: 宋体;">地址（</span><span style="font-family: Times New Roman;">window</span><span style="font-family: 宋体;">系统的</span><span style="font-family: Times New Roman;">ip</span><span style="font-family: 宋体;">），并关闭</span><span style="font-family: Times New Roman;">windows</span><span style="font-family: 宋体;">防火墙。如下图所示：</span></p>
<p>&nbsp;<img style="display: block; margin-left: auto; margin-right: auto;" src="http://images2015.cnblogs.com/blog/745188/201511/745188-20151128224926703-42015320.png" alt="" /></p>
<p>2<span style="font-family: 宋体;">、</span>ubuntu<span style="font-family: 宋体;">虚拟机，安装</span><span style="font-family: Times New Roman;">tftp</span><span style="font-family: 宋体;">服务，并安装</span><span style="font-family: Times New Roman;">wireshark</span>。</p>
<p>sudo&nbsp;apt-get&nbsp;install&nbsp;tftp</p>
<p>3<span style="font-family: 宋体;">、</span></p>
<p>打开<span style="font-family: Times New Roman;">wireshark.</span></p>
<p>启动tftp<span style="font-family: 宋体;">服务</span>，并连接<span style="font-family: Times New Roman;">window</span><span style="font-family: 宋体;">，</span>指定8000<span style="font-family: 宋体;">端口，这个端口号是没有进程在使用的</span>，当需要<span style="font-family: Times New Roman;">get</span><span style="font-family: 宋体;">文件，最终会显示</span>端口不可达，超时。</p>
<p>&nbsp;<img style="display: block; margin-left: auto; margin-right: auto;" src="http://images2015.cnblogs.com/blog/745188/201511/745188-20151128224954438-491391831.png" alt="" /></p>
<p>wireshark<span style="font-family: 宋体;">显示端口不可达。</span><span style="font-family: Times New Roman;">(window</span><span style="font-family: 宋体;">的</span><span style="font-family: Times New Roman;">ip:192.168.1.105</span><span style="font-family: 宋体;">，</span><span style="font-family: Times New Roman;">ubuntu</span><span style="font-family: 宋体;">的</span><span style="font-family: Times New Roman;">ip:192.168.1.114)</span></p>
<p>&nbsp;<img style="display: block; margin-left: auto; margin-right: auto;" src="http://images2015.cnblogs.com/blog/745188/201511/745188-20151128225005860-1950067818.png" alt="" /></p>
<p>&nbsp;ip首部内容。<img style="display: block; margin-left: auto; margin-right: auto;" src="http://images2015.cnblogs.com/blog/745188/201511/745188-20151128225027625-478022916.png" alt="" /></p>
<p>icmp<span style="font-family: 宋体;">部分，包括产生差错的</span><span style="font-family: Times New Roman;">ip</span><span style="font-family: 宋体;">数据报首部以及</span><span style="font-family: Times New Roman;">upd</span><span style="font-family: 宋体;">数据报首部。</span></p>
<p><img style="display: block; margin-left: auto; margin-right: auto;" src="http://images2015.cnblogs.com/blog/745188/201511/745188-20151128225115735-1937324179.png" alt="" /></p>
<p>&nbsp;</p>
<p>导致差错的数据报中的&nbsp;<span style="font-family: Times New Roman;">I&nbsp;P</span><span style="font-family: 宋体;">首部要被送回的原因是因为&nbsp;</span><span style="font-family: Times New Roman;">I&nbsp;P</span><span style="font-family: 宋体;">首部中包含了协议字段，使得</span><span style="font-family: Times New Roman;">I&nbsp;C&nbsp;M&nbsp;P</span><span style="font-family: 宋体;">可以知道如何解释后面的&nbsp;</span><span style="font-family: Times New Roman;">8</span><span style="font-family: 宋体;">个字节。如果我们来查看&nbsp;</span><span style="font-family: Times New Roman;">T&nbsp;C&nbsp;P</span><span style="font-family: 宋体;">首部</span>。<br />可以发现源端口和目的端口被包含在&nbsp;<span style="font-family: Times New Roman;">T&nbsp;C&nbsp;P</span><span style="font-family: 宋体;">首部的前</span><span style="font-family: Times New Roman;">8</span><span style="font-family: 宋体;">个字节中。</span></p>
<p>当<span style="font-family: Times New Roman;">I&nbsp;C&nbsp;M&nbsp;P</span><span style="font-family: 宋体;">报文返回时，为什么&nbsp;</span><span style="font-family: Times New Roman;">T&nbsp;F&nbsp;T&nbsp;P</span><span style="font-family: 宋体;">客户程序还要继续重发请求呢？这是由于网络编程中的一个因素，即&nbsp;</span><span style="font-family: Times New Roman;">B&nbsp;S&nbsp;D</span><span style="font-family: 宋体;">系统不把从插口&nbsp;</span><span style="font-family: Times New Roman;">(&nbsp;s&nbsp;o&nbsp;c&nbsp;k&nbsp;e&nbsp;t&nbsp;)</span><span style="font-family: 宋体;">接收到的&nbsp;</span><span style="font-family: Times New Roman;">I&nbsp;C&nbsp;M&nbsp;P</span><span style="font-family: 宋体;">报文中的</span><span style="font-family: Times New Roman;">U&nbsp;D&nbsp;P</span><span style="font-family: 宋体;">数据通知用户进程，除非该进程已经发送了一个&nbsp;</span><span style="font-family: Times New Roman;">c&nbsp;o&nbsp;n&nbsp;n&nbsp;e&nbsp;c&nbsp;t</span><span style="font-family: 宋体;">命令给该插口。标准的&nbsp;</span><span style="font-family: Times New Roman;">BSD&nbsp;TFTP</span><span style="font-family: 宋体;">客户程序并不发送</span><span style="font-family: Times New Roman;">c&nbsp;o&nbsp;n&nbsp;n&nbsp;e&nbsp;c&nbsp;t</span><span style="font-family: 宋体;">命令，因此它永远也不会收到&nbsp;</span><span style="font-family: Times New Roman;">I&nbsp;C&nbsp;M&nbsp;P</span><span style="font-family: 宋体;">差错报文的通知。</span></p>
<p>《<span style="font-family: Times New Roman;">TCP/IP</span><span style="font-family: 宋体;">详解》中的配图。</span></p>
<p><img style="display: block; margin-left: auto; margin-right: auto;" src="http://images2015.cnblogs.com/blog/745188/201511/745188-20151128225144375-345525735.png" alt="" /></p>
<p>&nbsp;</p>